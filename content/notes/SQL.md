---
title: "SQL"
date: 2020-09-15T11:03:10+08:00
draft: true
tags: ["",""]
---
# SQL Structured Query Language
- SQL是结构化查询语言的缩写，用来访问和操作数据库系统。SQL语句既可以查询数据库中的数据，也可以添加、更新和删除数据库中的数据，还可以对数据库进行管理和维护操作。不同的数据库，都支持SQL，通过学习SQL这一种语言，就可以操作各种不同的数据库。
## SQL 能力
- DDL：Data Definition Language
- - DDL允许用户定义数据，也就是创建表、删除表、修改表结构这些操作。通常，DDL由数据库管理员执行。
- - DML：Data Manipulation Language
- - DML为用户提供添加、删除、更新数据的能力，这些是应用程序对数据库的日常操作。
- DQL：Data Query Language
- - DQL允许用户查询数据，这也是通常最频繁的数据库日常操作。
## 数据库
- 解决问题;
- - 读写文件并解析出数据需要大量重复代码；
- - 从成千上万的数据中快速查询出指定数据需要复杂的逻辑。
## 数据类型
对- 于一个关系表，除了定义每一列的名称外，还需要定义每一列的数据类型。关系数据库支持的标准数据类型包括数值、字符串、时间等：

名称|	类型|	说明|
|--|--|--|
INT	|整型	|4字节整数类型，范围约+/-21亿|
BIGINT|	长整型|	8字节整数类型，范围约+/-922亿亿|
REAL|	浮点型|	4字节浮点数，范围约+/-1038|
DOUBLE|	浮点型|	8字节浮点数，范围约+/-10308|
DECIMAL(M,N)|	高精度小数|	由用户指定精度的小数，例如，DECIMAL(20,10)表示一共20位，其中小数10位，通常用于财务计算|
CHAR(N)	|定长字符串	|存储指定长度的字符串，例如，CHAR(100)总是存储100个字符的字符串|
VARCHAR(N)|	变长字符串	|存储可变长度的字符串，例如，VARCHAR(100)可以存储0~100个字符的字符串|
BOOLEAN	布尔类型|	存储True或者False|
DATE	|日期类型|	存储日期，例如，2018-06-22|
TIME	|时间类型	|存储时间，例如，12:20:59|
DATETIME|	日期和时间类型|	存储日期+时间，例如，2018-06-22 12:20:59|
## 数据模型
- A：对于层次模型，采用的是树（二叉树）的结构来表达实体和实体间联系（上下级关系）
- B：网状模型，采用的是图的结构来表达实体和实体间联系（像城市道路一样连接各个城市）
- C：关系模型，就是用的二维表

候选键(Candidate Key)：一个或者多个属性的集合，可以唯一确定实体的一个实例；
主键(Primary Key):从候选键中，选中用来作为唯一标识的属性或者属性组被称为主键；
可选键(Alternative Key):候选键中没有选中的其他键，称为可选键；
而表的外键是另一表的主键, 外键可以有重复的, 可以是空值。

活锁就是事务T有可能永远等待，而死锁是指T1和T2 两个事务永远不能结束

第一范式：所有属性必须是原子的，某个属性有多个值时，必须拆分成不同的属性
第二范式：需满足1NF，非码属性必须完全依赖于候选码；即数据库中的每个实例或记录可以被唯一的区分。简而言之，第二范式就是在第一范式的基础上属性完全依赖于主键。
第三范式：在2NF基础上，任何非主属性不依赖于其他非主属性。换言之，第三范式（3NF）要求一个关系中不包含已在其它关系已包含的非主关键字信息。即关系不能包含其他关系中非主键的信息。
巴斯-科徳范式：在3NF基础上，任何非主属性不能对主键子集依赖（在3NF基础上消除对主码子集的依赖），为第三范式的修正
第四范式：限制关系模式的属性之间不允许有非平凡且非函数依赖的多值依赖。当一个表中的非主属性互相独立时（3NF），这些非主属性不应该有多值，若有多值就违反了4NF。
第五范式：表必须可以分解为较小的表，除非那些表在逻辑上拥有与原始表相同的主键。用来处理消除所有的业务冗余，以独立的表来表达每一个业务需求。

1、sql server中删除约束的语句是：
alter table 表名 drop constraint 约束名
sp_helpconstraint 表名 找到数据表中的所有列的约束
2、oracle中删除约束的语句：
先找到表的约束名称，执行：
select * from user_constraints； 其中 CONSTRAINT_NAME 为表的约束名称
然后删除约束：
alter table 表名 drop constraint 约束名 cascade;
3、mysql中删除约束的语句是：
1）删除主键约束：
alter table 表名 drop primary key;
2）删除外键约束：alter table 表名 drop foreign key 外键（区分大小写）;

存储过程是由流控制和SQL语句书写的过程，这个过程经编译和优化后存储在数据库服务器中，使用时只要调用即可。 使用存储过程有以下的优点： 1.存储过程的能力大大增强了SQL语言的功能和灵活性。存储过程可以用流控制语句编写，有很强的灵活性，可以完成复杂的判断和较复杂的 运算。 2.可保证数据的安全性和完整性。 3.通过存储过程可以使没有权限的用户在控制之下间接地存取数据库，从而保证数据的安全。 4.通过存储过程可以使相关的动作在一起发生，从而可以维护数据库的完整性。 5.再运行存储过程前，数据库已对其进行了语法和句法分析，并给出了优化执行方案。这种已经编译好的过程可极大地改善SQL语句的性能。 由于执行SQL语句的大部分工作已经完成，所以存储过程能以极快的速度执行。 6.可以降低网络的通信量。 7.使体现企业规则的运算程序放入数据库服务器中，以便集中控制。 当企业规则发生变化时在服务器中改变存储过程即可，无须修改任何应用程序。企业规则的特点是要经常变化，如果把体现企业规则的运 算程序放入应用程序中，则当企业规则发生变化时，就需要修改应用程序工作量非常之大（修改、发行和安装应用程序）。如果把体现企业规则的 运算放入存储过程中，则当企业规则发生变化时，只要修改存储过程就可以了，应用程序无须任何变化。

1.若视图是由两个以上基本表导出的，则此视图不允许更新。
2.若视图的字段来自字段表达式或常数，则不允许对视图执行INSTER和UPDATE操作，但允许delete。
3.若视图的字段来自聚集函数，则此视图不允许更新。
4.若视图中含有GROUP by子句，则此视图不允许更新。
5.若视图中含有DISTINCT短语，则此视图不允许更新。.
6若视图定义中有嵌套查询，并且内层查询的FROM子句中涉及的表也是导出该视图的基本表，则此视图不允许更新。.
7.一个不允许更新的视图上定义的视图不允许更新。

视图是由从数据库的基本表中选取出来的数据组成的逻辑窗口，不同于基本表，它是一个虚表，在数据库中，存放的只是视图的定义而已，而不存放数据，这些数据仍然存放在原来的基本表结构中。只有在使用视图的时候才会执行视图的定义，从基本表中查询数据。

视图的作用非常多，主要有以下几点：首先，它可以简化数据查询语句；其次，它可以使用户从多角度看待同一数据；再次，它可以提高数据的安全性；最后，它提供了一定程度的逻辑独立性等。

通过引入视图机制，用户可以将注意力集中在其关心的数据上而非全部数据，这样就大大提高了用户效率与用户满意度，而且如果这些数据来源于多个基本表结构，或者数据不仅来自于基本表结构，还有一部分数据来源于其他视图，并且搜索条件又比较复杂时，需要编写的查询语句就会比较繁琐，此时定义视图就可以使数据的查询语句变得简单可行。定义视图可以将表与表之间复杂的操作连接和搜索条件对用户不可见，用户只需要简单地对一个视图进行查询即可，所以，增加了数据的安全性，但是不能提高查询的效率。

对于选项A，视图可以被定义为多个表的连接，也可以被定义为只有部分列可见，或满足条件的部分行可见，因此，有更强的定义功能。所以，选项A正确。

对于选项B，视图有的操作表都有，视图一般被用来查找而使用。所以，选项B错误。

对于选项C，视图的数据控制能力要强于表，视图可以被定义为多个表的连接，也可以被定义为只有部分列可见，或满足条件的部分行可见，通过定义不同的存储过程，并授予不同的权限，可以很灵活地对数据进行控制。所以，选项C错误。

对于选项D，自然也就错了。